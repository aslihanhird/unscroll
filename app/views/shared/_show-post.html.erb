<div class="single-post-wrapper small-padding" data-posts-target="post" data-action="touchstart->posts#swipe">

  <div class="post-card">

    <%# CARD TOP WITH INFO %>

    <div class="card-top">

      <div class="user-info">
          <%= cl_image_tag(post.profile.photo.key, class: "avatar shadowed") %>
          <p><%= post.profile.username %></p>
      </div>

      <div class="user-actions">

        <% if post.source == "instagram" %>
          <i class="fa-brands fa-instagram"></i>
        <% else %>
          <i class="fa-brands fa-twitter"></i>
        <% end %>

        <% if post.favourite %>
          <i class="fa-solid fa-bookmark"></i>
        <% else %>
          <i class="fa-regular fa-bookmark"></i>
        <% end %>
      </div>

    </div>
      <%# If it's a photo, display it normally %>
      <% if post.media_type == 'photo' %>
        <%= cl_image_tag(post.photos[0].key, class:"post-card") %>
        <%= render "shared/post-caption", post: post %>

      <%# If it's a video, display it normally %>
      <% elsif post.media_type == 'video' %>
        <%= cl_video_tag(post.videos[0].key, class: "post-card", preload: "none", controls: true) %>
        <%= render "shared/post-caption", post: post %>

      <%# If it's a carousel, do some weird stuff %>
      <% elsif post.media_type == 'carousel' %>
        <div data-controller="carousel">
          <% i = 0 %>
          <% j = 0 %>
          <% post.media_keys.each do |media| %>
            <% if media == 'photo' %>
              <%= cl_image_tag(post.photos[i].key, class:"post-card", data: {carousel_target: "media"}) %>
              <% i += 1 %>
            <% elsif media == 'video' %>
              <%= cl_video_tag(post.videos[j].key, class: "post-card", preload: "none", controls: true, data: {carousel_target: "media"}) %>
              <% j += 1 %>
            <% end %>
          <% end %>
          <%= render "shared/post-caption", post: post %>
        </div>

       <% else %>
        <p class="hyphens"><%= post.caption %></p>
      <% end %>

    <%# CAPTION %>



  </div>
</div>
